# 크롤링 애플리케이션 개선 요구사항 명세서

## 개요
다음은 Matter 인증 정보 크롤링 애플리케이션의 사용자 경험 및 기능 개선을 위한 요구사항입니다. 이 요구사항들은 우선순위에 따라 구현되어야 합니다.

## 1. 진행 상황 표시 개선 (UI-PROG-001)
**설명:** 현재 크롤링 두 번째 단계(Product Detail 수집) 진행 중 UI Progress 바가 업데이트되지 않는 문제가 있습니다.

**요구사항:**
- Product Detail 수집 단계에서 실시간으로 진행률을 UI Progress 바에 반영해야 합니다.
- 각 제품 처리 완료 시마다 또는 최소 3초 간격으로 진행률을 업데이트해야 합니다.
- 진행률은 처리된 제품 수 / 전체 제품 수의 비율로 계산되어야 합니다.
- 진행률 숫자(예: 45%)와 함께 처리된 항목 수(예: 45/100)도 표시해야 합니다.

**성공 기준:** 사용자가 Product Detail 수집 과정에서 실시간으로 정확한 진행 상황을 확인할 수 있어야 합니다.

## 2. 수집 페이지 범위 선택 기능 (CRAWL-RANGE-001)
**설명:** 수집할 페이지 수를 사용자가 선택할 수 있는 기능이 필요합니다.

**요구사항:**
- 현재 시스템은 1단계에서 페이지 수집 실패 시 전체 크롤링을 중단합니다. 따라서 너무 큰 범위일수록 크롤링 중단 가능성이 높아집니다.
- 크롤링 시작 전, 로컬 데이터베이스 상태와 비교하여 추가 수집이 필요한 페이지 범위를 표시해야 합니다.
- 사용자가 수집할 페이지 수를 직접 지정할 수 있는 입력 필드를 제공해야 합니다:
  - 이 입력 필드에는 기본적으로 전체 범위가 입력되어 있어야 합니다.
  - 페이지 수 입력 시 실제로 수집될 페이지 범위(시작 페이지~끝 페이지)를 표시해야 합니다.
  - 페이지 번호는 1번이 최신 페이지를 의미합니다(번호가 클수록 오래된 페이지).
- 페이지 범위 선택 시 다음 정보를 함께 표시해야 합니다:
  - 예상 수집 제품 수(페이지당 평균 12개 제품 기준)
  - 예상 소요 시간(이전 크롤링 데이터의 페이지당 평균 처리 시간 기준)

**성공 기준:** 사용자가 원하는 페이지 수만큼 수집 범위를 선택할 수 있고, 이에 따라 크롤링이 수행됩니다.

## 3. 재시도 횟수 설정 기능 (CRAWL-RETRY-001)
**설명:** 현재 Product List 수집(1단계)과 Product Detail 수집(2단계) 모두 고정된 재시도 횟수를 사용합니다. 사용자가 이 값을 조정할 수 있어야 합니다.

**요구사항:**
- 크롤링 설정 UI에 각 단계별 재시도 횟수를 설정할 수 있는 입력 필드를 추가해야 합니다:
  - Product List 수집 재시도 횟수 (기본값: 9회)
  - Product Detail 수집 재시도 횟수 (기본값: 9회)
- 입력값은 3~20 사이의 정수로 제한되어야 합니다.
- 설정된 재시도 횟수는 애플리케이션 재시작 후에도 유지되어야 합니다.

**성공 기준:** 사용자가 각 크롤링 단계의 재시도 횟수를 자유롭게 설정할 수 있으며, 이 설정이 크롤링 과정에 정확히 반영됩니다.

## 4. 재시도 진행 상태 상세 표시 (UI-STATUS-001)
**설명:** 현재 재시도 과정의 상세 정보가 충분히 표시되지 않아 사용자가 진행 상황을 정확히 파악하기 어렵습니다.

**요구사항:**
- 크롤링 상태 표시 영역에 다음 정보를 명확히 표시해야 합니다:
  - 현재 처리 중인 단계 (1단계: Product List / 2단계: Product Detail)
  - 현재 단계의 총 재시도 횟수 설정값
  - 현재 진행 중인 재시도 횟수 (예: "재시도 2/9 진행 중")
  - 재시도 대상 항목의 ID 또는 URL
- 재시도 발생 시 로그 영역에 다음 정보를 기록해야 합니다:
  - 재시도 원인(오류 메시지)
  - 재시도 횟수 카운트
  - 대상 항목 식별 정보
  - 재시도 시간

**성공 기준:** 사용자가 재시도 과정의 현재 상태, 진행 상황 및 남은 재시도 횟수를 명확하게 확인할 수 있습니다.

## 구현 우선순위
1. UI-PROG-001: 진행 상황 표시 개선 (높음)
2. CRAWL-RETRY-001: 재시도 횟수 설정 기능 (중간)
3. UI-STATUS-001: 재시도 진행 상태 상세 표시 (중간)
4. CRAWL-RANGE-001: 수집 페이지 범위 선택 기능 (낮음)
