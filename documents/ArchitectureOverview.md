# Matter 인증 정보 수집기 소프트웨어 아키텍처 개요

## 소프트웨어 구조 블록 다이어그램

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                          웹 애플리케이션 레이어 (UI)                            │
│                                                                             │
│  ┌───────────────────┐  ┌───────────────────┐  ┌────────────────────────┐  │
│  │                   │  │                   │  │                        │  │
│  │   React 컴포넌트   │  │    UI 유틸리티     │  │     시각화 컴포넌트      │  │
│  │  (App.tsx, 등)    │  │  (useStatistics.ts)│  │    (BaseChart.tsx,    │  │
│  │                   │  │                   │  │     Charts.tsx)        │  │
│  └─────────┬─────────┘  └──────────┬────────┘  └───────────┬────────────┘  │
│            │                       │                       │                │
│            └───────────────────────┼───────────────────────┘                │
│                                    │                                        │
│                           ┌────────▼─────────┐                              │
│                           │                  │                              │
│                           │   상태 관리 계층   │                              │
│                           │   (stores.ts)    │                              │
│                           │                  │                              │
│                           └────────┬─────────┘                              │
│                                    │                                        │
└────────────────────────────────────┼────────────────────────────────────────┘
                                     │                                         
                            ┌────────▼─────────┐                              
                            │                  │                              
                            │   플랫폼 API 계층  │                              
                            │    (api.ts)      │                              
                            │                  │                              
                            └────────┬─────────┘                              
                                     │                                         
     ┌─────────────────────────────────────────────────────────────────┐      
     │                               │                                 │      
     │                               │                                 │      
┌────▼────────────────┐     ┌────────▼─────────┐              ┌────────▼─────────┐
│                     │     │                  │              │                  │
│   Mock 데이터 서비스  │     │   Electron API    │              │    (미래) Tauri   │
│  (mockData.ts)      │     │   (preload.cts)   │              │       API        │
│                     │     │                   │              │                  │
└─────────────────────┘     └─────────┬─────────┘              └──────────────────┘
                                      │                                  
                            ┌─────────▼─────────┐                              
                            │                  │                              
                            │  Electron 메인    │                              
                            │   프로세스 계층    │                              
                            │  (main.ts, 등)   │                              
                            │                  │                              
                            └────────┬─────────┘                              
                                     │                                         
                    ┌────────────────┼────────────────────┐                   
                    │                │                    │                   
              ┌─────▼─────┐    ┌─────▼─────┐        ┌─────▼─────┐             
              │           │    │           │        │           │             
              │  크롤링 모듈 │    │ 데이터베이스 │        │ 리소스 관리 │             
              │ (Playwright)│    │  (SQLite)  │        │    모듈    │             
              │           │    │           │        │           │             
              └───────────┘    └───────────┘        └───────────┘             
```

## 레이어 설명

### 1. 웹 애플리케이션 레이어 (UI)

이 레이어는 사용자 인터페이스를 담당하며 React로 구현되어 있습니다.

#### 주요 컴포넌트:
- **React 컴포넌트**: 애플리케이션의 UI 요소를 구성하는 컴포넌트들
  - `App.tsx`: 애플리케이션의 루트 컴포넌트
  - 기타 UI 컴포넌트
  
- **UI 유틸리티**: UI와 관련된 로직을 처리하는 유틸리티
  - `useStatistics.ts`: 시스템 통계 데이터를 처리하는 훅

- **시각화 컴포넌트**: 데이터 시각화를 위한 컴포넌트
  - `BaseChart.tsx`: 차트의 기본 구성 요소
  - `Charts.tsx`: 다양한 차트를 구현하는 컴포넌트

### 2. 상태 관리 계층

애플리케이션 전체의 상태를 관리하고 UI와 비즈니스 로직 사이의 중개자 역할을 합니다.

- **`stores.ts`**: nanostores를 사용한 상태 관리
  - `appModeStore`: 개발/실사용 모드 상태 관리
  - `crawlingStatusStore`: 크롤링 진행 상태 관리
  - `logsStore`: 로그 관리
  - `productsStore`: 제품 데이터 관리
  - 기타 상태 저장소 및 액션 함수들

### 3. 플랫폼 API 계층

다양한 백엔드 통신을 추상화하는 인터페이스 계층으로, 서로 다른 플랫폼(Electron, Tauri)과의 통신을 일관된 방식으로 처리합니다.

- **`api.ts`**: 플랫폼 독립적인 API 인터페이스
  - `IPlatformAPI` 인터페이스: 이벤트 구독 및 메소드 호출을 위한 표준 인터페이스
  - `ElectronApiAdapter`, `MockApiAdapter`: 각 플랫폼별 구현체
  - 향후 `TauriApiAdapter` 추가 예정

### 4. 백엔드 통신 구현체

플랫폼 API의 실제 구현체들입니다.

- **Mock 데이터 서비스**:
  - `mockData.ts`: 개발 모드에서 사용되는 Mock 데이터 및 시뮬레이션 기능
  - 실제 API 없이도 UI 개발 및 테스트가 가능하도록 지원

- **Electron API**:
  - `preload.cts`: 렌더러 프로세스와 메인 프로세스 간의 통신 중개
  - IPC 통신을 통한 메소드 호출 및 이벤트 구독 구현

- **(미래) Tauri API**:
  - 향후 구현 예정인 Tauri 기반 통신 어댑터

### 5. Electron 메인 프로세스 계층

Electron의 메인 프로세스에서 실행되는 기능들로, 시스템 리소스 접근 및 무거운 작업을 처리합니다.

- **`main.ts`**: Electron 애플리케이션의 진입점
  - 창 관리, IPC 핸들러 등록, 앱 라이프사이클 관리

- **`pathResolver.ts`**: 파일 경로 관리
  - OS별 다른 경로 처리 및 리소스 접근 경로 제공

- **`util.ts`**: 유틸리티 함수
  - 개발/배포 환경 감지, 기타 헬퍼 함수

- **`resourceManager.ts`**: 리소스 관리
  - 애플리케이션에서 사용하는 리소스 관리 및 접근 제공

### 6. 백엔드 기능 모듈

메인 프로세스에서 실행되는 핵심 기능 모듈들입니다.

- **크롤링 모듈**:
  - Playwright를 사용한 웹 크롤링 구현
  - 병렬 처리 및 에러 핸들링 로직

- **데이터베이스 모듈**:
  - SQLite를 사용한 로컬 데이터 저장
  - better-sqlite3을 통한 데이터베이스 접근

- **리소스 관리 모듈**:
  - 파일 시스템 접근 및 관리
  - 설정 저장 및 불러오기

## 데이터 흐름

1. **UI → 상태 관리**: 사용자 인터랙션이 상태 관리 계층의 액션을 호출
2. **상태 관리 → 플랫폼 API**: 액션이 플랫폼 API 메소드를 호출
3. **플랫폼 API → 백엔드**: API 호출이 적절한 백엔드 구현체로 전달
4. **백엔드 → 데이터 처리**: 백엔드에서 요청 처리 (크롤링, 데이터 저장 등)
5. **백엔드 → 플랫폼 API**: 결과나 이벤트가 API 계층으로 전달
6. **플랫폼 API → 상태 관리**: 이벤트 구독을 통해 상태 업데이트
7. **상태 관리 → UI**: 상태 변경이 UI 업데이트 트리거

## 주요 설계 원칙

### 1. 관심사 분리
UI, 상태 관리, 백엔드 통신, 실제 작업 처리 등이 명확하게 분리되어 각 계층이 독립적으로 발전할 수 있습니다.

### 2. 플랫폼 독립적 설계
`IPlatformAPI` 인터페이스를 통해 플랫폼 종속성을 최소화하고, 향후 Tauri로의 마이그레이션을 용이하게 합니다.

### 3. 개발/실사용 모드 분리
Mock 데이터 서비스를 통해 백엔드 구현 없이도 UI 개발이 가능하도록 지원합니다.

### 4. 비동기 작업 처리
크롤링 같은 무거운 작업은 백그라운드에서 처리하고, 진행 상황을 이벤트로 전달하여 UI 응답성을 유지합니다.

## 기술적 특징

1. **타입스크립트 기반**: 전체 프로젝트가 타입스크립트로 작성되어 타입 안정성과 개발 생산성을 높입니다.

2. **어댑터 패턴**: 플랫폼 API 계층에서 어댑터 패턴을 사용하여 다양한 백엔드 구현체를 일관된 인터페이스로 제공합니다.

3. **이벤트 기반 통신**: 백엔드에서 UI로의 통신은 이벤트 구독 방식을 사용하여 느슨한 결합을 유지합니다.

4. **디펜던시 인젝션**: 상태 관리 계층이 플랫폼 API에 의존하지만, API 구현체는 런타임에 결정되어 유연성을 제공합니다.

5. **비동기 작업 관리**: Promise 기반의 비동기 작업 처리로 장시간 작업도 UI 블로킹 없이 처리합니다.

## 향후 개선 방향

1. **Tauri 마이그레이션 준비**: 구조적으로 Tauri로의 마이그레이션이 용이하도록 설계되었으며, 필요시 TauriApiAdapter 구현만 추가하면 됩니다.

2. **테스트 환경 강화**: Mock 데이터를 활용한 테스트 환경이 준비되어 있으나, 자동화된 테스트 케이스 추가가 필요합니다.

3. **에러 처리 개선**: 현재 기본적인 에러 처리 외에 더 세분화된 에러 케이스 관리 및 복구 메커니즘이 필요합니다.

4. **성능 최적화**: 대량의 데이터 처리 시 성능 최적화를 위한 전략(가상 스크롤, 데이터 청킹 등)이 필요합니다.

5. **국제화 지원**: 다국어 지원을 위한 i18n 시스템 도입이 고려됩니다.